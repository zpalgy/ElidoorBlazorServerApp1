@using BlazorServerApp1.Data

@page "/Movingwing"

@inherits MovingwingBase

@inject IJSRuntime Js

<style>
    th, td {
        padding: 15px;
        text-align: center;
    }
</style>
@code
{
    [Parameter]
    public DoorConfig doorConfig { get; set; }

    [Parameter]
    public bool disableLogo { get; set; }
}

<table id="MovingWingL1">
    <tr>

        <th id="thOpenSide" hidden="@UiLogic.hideFld(doorConfig, "OpenSide")">כיוון פתיחה (R,L)</th>
        <th id="thDecorFormat" hidden="@UiLogic.hideFld(doorConfig, "DecorFormat")">עיצוב דקורציה (חוץ,פנים,דו צדדי)</th>
        <th id="thTwoColors" hidden="@UiLogic.hideFld(doorConfig, "TwoColors")">צביעה בשני צבעים</th>
        <th id="thDoorWidth" hidden="@UiLogic.hideFld(doorConfig, "DoorWidth")">רוחב דלת</th>
        <th id="thDoorColor" hidden="@UiLogic.hideFld(doorConfig, "DoorColor")">גוון דלת</th>
    </tr>
    <tr>
        <td id="tdOpenSide" hidden="@UiLogic.hideFld(doorConfig, "OpenSide")">
            <select name="dlstOpenSide" @bind="openSide" disabled="@UiLogic.disableFld(doorConfig, "dlstOpenSide")">
                <option> </option>
                <option>ימין</option>
                <option>שמאל</option>
            </select>
            @code
            {
                protected string _openSide = string.Empty;
                protected string openSide
                {
                    get
                    {
                        if (doorConfig != null)
                        {
                            _openSide = doorConfig.OPENSIDE;
                        }
                        return _openSide;
                    }
                    set
                    {
                        _openSide = value;
                        if (doorConfig != null)
                            doorConfig.OPENSIDE = _openSide;
                    }
                }

            }
        </td>
        <td id="tdDecorFormat" hidden="@UiLogic.hideFld(doorConfig, "DecorFormat")">
            <select name="dlstDecorFormat" @bind="DecorFormat">
                <option>ללא</option>
                <option>חוץ</option>
                <option>פנים</option>
                <option disabled="@UiLogic.disableOption(doorConfig,"dlstDecorFormat","דו צדדי")">דו צדדי</option>
                @* see Helper.DecorFormat2Code(...) method *@
            </select>
        </td>
        @code {
            protected string _DecorFormat = string.Empty;
            protected string DecorFormat
            {
                get
                {
                    if (doorConfig != null)
                    {
                        // UiLogic.applyFldDefault(doorConfig, "dlstDecorFormat");
                        _DecorFormat = doorConfig.DECORFORMAT;
                    }
                    return _DecorFormat;
                }
                set
                {
                    _DecorFormat = value;
                    if (doorConfig != null)
                        doorConfig.DECORFORMAT = _DecorFormat;
                }
            }

        }
        <td id="tdTwoColors" hidden="@UiLogic.hideFld(doorConfig, "TwoColors")">
            <input type="checkbox" name="chkbTwoColors" @bind="TwoColors" />
        </td>
        @code
        {
            protected bool _TwoColors = false;
            protected bool TwoColors
            {
                get
                {
                    if (doorConfig != null)
                    {
                        _TwoColors = (doorConfig.TWOCOLORS == "Y");
                    }
                    return _TwoColors;
                }
                set
                {
                    _TwoColors = value;
                    if (doorConfig != null)
                        doorConfig.TWOCOLORS = (_TwoColors ? "Y" : "");
                }
            }

        }
        <td id="tdDoorWidth" hidden="@UiLogic.hideFld(doorConfig, "DoorWidth")">
            <input name="txtDoorWidth" type="number" @bind="DoorWidth" />
        </td>
        @code
        {
            protected int _DoorWidth = 0;
            protected int DoorWidth
            {
                get
                {
                    if (doorConfig != null)
                    {
                        _DoorWidth = doorConfig.DOORWIDTH;
                    }
                    return _DoorWidth;
                }
                set
                {
                    _DoorWidth = value;
                    if (doorConfig != null)
                    {
                        doorConfig.DOORWIDTH = _DoorWidth;
                        //[TODO] implement the following lines
                        //if (chkbComplient.Checked)
                        //     txtWindowWidth.Text = calcWindowWidth();
                        if (!string.IsNullOrEmpty(doorConfig.PARTNAME) && doorConfig.COMPLIENTDOOR == "Y")
                        {
                            string errMsg = string.Empty;
                            doorConfig.WINDOWWIDTH = calcWindowWidth(doorConfig, ref errMsg);
                            if (doorConfig.WINDOWWIDTH == 0 && !string.IsNullOrEmpty(errMsg))
                            {
                                Js.InvokeVoidAsync("alert", errMsg);
                            }
                        }
                    }
                }
            }
        }

        <td id="tdDoorColor" hidden="@UiLogic.hideFld(doorConfig, "DoorColor")">
            <select name="dlstDoorColor" @bind="DoorColorId">
                @if (PrApiCalls.lstColors != null)
                {
                    @foreach (TRSH_COLOR_Class c in PrApiCalls.lstColors)
                    {
                        <option value="@c.TRSH_COLORID">@c.TRSH_COLORDES</option>
                    }
                }
            </select>
        </td>
        @code
        {

            protected int _DoorColorId = 0;
            protected int DoorColorId
            {
                get
                {
                    if (doorConfig != null)
                    {
                        _DoorColorId = doorConfig.DOORCOLORID;
                    }
                    return _DoorColorId;
                }
                set
                {
                    _DoorColorId = value;
                    if (doorConfig != null)
                        doorConfig.DOORCOLORID = _DoorColorId;
                }
            }

        }
    </tr>
</table>
<!-- end table MovingWingL1 -->
<br />
<table id="MovingWingL2">
    <tr>
        <th id="thDoorHeight" hidden="@UiLogic.hideFld(doorConfig, "DoorHeight")">גובה דלת</th>
        <th id="thTurboApparatus" hidden="@UiLogic.hideFld(doorConfig, "TurboApparatus")">מנגנון תגבור</th>
        <th id="thLockDrilHeight" hidden="@UiLogic.hideFld(doorConfig, "LockDrilHeight")">גובה ניקוב / מרכז לשונית</th>
        <th id="thLogo" hidden="@UiLogic.hideFld(doorConfig, "Logo")">לוגו</th>
        <th id="thHw" hidden="@UiLogic.hideFld(doorConfig, "Hw")">פירזול</th>
        <th id="thHwColor" hidden="@UiLogic.hideFld(doorConfig, "HwColor")">פירזול בצבע</th>
        <th id="thDril4Hw" hidden="@UiLogic.hideFld(doorConfig, "Dril4Hw")">ניקוב פירזול</th>
    </tr>
    <tr>
        <td id="tdDoorHeight" hidden="@UiLogic.hideFld(doorConfig, "DoorHeight")">
            <input name="txtDoorHeight" type="number" @bind="DoorHeight" />
        </td>
        @code
        {
            protected int _DoorHeight = 0;
            protected int DoorHeight
            {
                get
                {
                    if (doorConfig != null)
                    {
                        _DoorHeight = doorConfig.DOORHEIGHT;
                    }
                    return _DoorHeight;
                }
                set
                {
                    _DoorHeight = value;
                    if (doorConfig != null)
                    {
                        doorConfig.DOORHEIGHT = _DoorHeight;
                        //[TODO] implement the following lines
                        //if (chkbComplient.Checked)
                        //     txtWindowWidth.Text = calcWindowWidth();
                        if (!string.IsNullOrEmpty(doorConfig.PARTNAME) && doorConfig.COMPLIENTDOOR == "Y")
                        {
                            string errMsg2 = string.Empty;
                            setHingesAndWindowsData(doorConfig, ref errMsg2);
                            if (doorConfig.WINDOWHEIGHT == 0 && !string.IsNullOrEmpty(errMsg2))
                            {
                                Js.InvokeVoidAsync("alert", errMsg2);
                            }
                        }

                        string errMsg = string.Empty;
                        doorConfig.WINDOWWIDTH = calcWindowWidth(doorConfig, ref errMsg);
                        if (doorConfig.WINDOWWIDTH == 0 && !string.IsNullOrEmpty(errMsg))
                        {
                            Js.InvokeVoidAsync("alert", errMsg);
                        }
                    }
                }
            }
        }

        <td id="tdTurboApparatus" hidden="@UiLogic.hideFld(doorConfig, "TurboApparatus")">
            <input type="checkbox" name="chkbTurboApparatus" @bind="TurboApparatus" />
        </td>
        @code
        {
            protected bool _TurboApparatus = false;
            protected bool TurboApparatus
            {
                get
                {
                    if (doorConfig != null)
                    {
                        _TurboApparatus = (doorConfig.TURBOAPPARATUS == "Y");
                    }
                    return _TurboApparatus;
                }
                set
                {
                    _TurboApparatus = value;
                    if (doorConfig != null)
                        doorConfig.TURBOAPPARATUS = (_TurboApparatus ? "Y" : "");
                }
            }

        }
        <td id="tdLockDrilHeight" hidden="@UiLogic.hideFld(doorConfig, "LockDrilHeight")">
            <input name="txtLockDrilHeight" type="number" @bind="LockDrilHeight" />
        </td>
        @code
        {
            protected int _LOckDrilHeight = 0;
            protected int LockDrilHeight
            {
                get
                {
                    if (doorConfig != null)
                    {
                        _LOckDrilHeight = doorConfig.LOCKDRILHEIGHT;
                    }
                    return _LOckDrilHeight;
                }
                set
                {
                    _LOckDrilHeight = value;
                    if (doorConfig != null)
                        doorConfig.LOCKDRILHEIGHT = _LOckDrilHeight;
                }
            }
        }
        <td id="tdLogo" hidden="@UiLogic.hideFld(doorConfig, "Logo")">
            <input type="checkbox" name="chkbLogo" @bind="Logo" disabled="@disableLogo" />
        </td>
        @code
        {
            protected bool _Logo = false;
            protected bool Logo
            {
                get
                {
                    if (doorConfig != null)
                    {
                        _Logo = (doorConfig.LOGO == "Y");
                    }
                    return _Logo;
                }
                set
                {
                    _Logo = value;
                    if (doorConfig != null)
                        doorConfig.LOGO = (_Logo ? "Y" : "");
                }
            }

        }
        <td id="tdHw" hidden="@UiLogic.hideFld(doorConfig, "Hw")">
            <select name="dlstHw" @bind="Hw">
                @{
                    string errMsg = string.Empty;
                    List<TRSH_HARDWARE_Class> lstPartHWs = PrApiCalls.getPartHWs(doorConfig.TRSH_DOOR_HWCATCODE, ref errMsg);

                    if (lstPartHWs != null)
                    {
                        @foreach (TRSH_HARDWARE_Class c in lstPartHWs)
                        {
                            <option value="@c.TRSH_HARDWARE">@c.HARDWAREDES</option>
                        }
                    }
                }
            </select>
            @code
            {
                protected int _Hw = 0;
                protected int Hw
                {
                    get
                    {
                        if (doorConfig != null)
                        {
                            _Hw = doorConfig.TRSH_HARDWARE;
                        }
                        return _Hw;
                    }
                    set
                    {
                        _Hw = value;
                        if (doorConfig != null)
                            doorConfig.TRSH_HARDWARE = _Hw;
                    }
                }
            }
        </td>
        <td id="tdHwColor" hidden="@UiLogic.hideFld(doorConfig, "HwColor")">
            <select name="dlstHwColor"
                    DataValueField="TRSH_COLORID"
                    DataTextField="TRSH_COLORDES"
                    SelectMethod="getColors"
                    OnSelectedIndexChanged="ctl_valChanged"
                    onChange="clearFollowingTabs('movingwing')" />
        </td>
        <td id="tdDril4Hw" hidden="@UiLogic.hideFld(doorConfig, "Dril4Hw")">
            <select name="dlstDril4Hw"
                    DataValueField="DRIL4HW"
                    DataTextField="DRIL4HWDES"
                    SelectMethod="getDril4Hws"
                    OnSelectedIndexChanged="ctl_valChanged"
                    onChange="Dril4Hw_change()" />
        </td>
    </tr>
</table>
<!-- end MovingWingL2 -->
<br />
<table id="MovingWingL3">
    <tr>
        <th id="thCylinder">צילינדר</th>
        <th id="thElectricApparatus">מנגנון חשמלי</th>
        <th id="thLock">מנעול</th>
        <th id="thTwoSidesIDSDril">ניקוב שני צדדים IDS</th>
        <th id="thRafafa">תוספת רפפה עשן/פתח איוורור בכנף הנעה</th>
        <th id="thLCDEye">LCD עינית</th>
    </tr>
    <tr>
        <td id="tdCylinder">
            <asp:DropDownList ID="dlstCylinder" AutoPostBack="false"
                              DataValueField="CYLINDERNAME"
                              DataTextField="CYLINDERDES"
                              SelectMethod="getCylinders"
                              OnSelectedIndexChanged="ctl_valChanged"
                              onChange="clearFollowingTabs('movingwing')" />
        </td>
        <td id="tdElectricApparatus">
            <asp:CheckBox ID="chkbElectricApparatus" AutoPostBack="false"
                          OnCheckedChanged="ctl_valChanged"
                          onChange="clearFollowingTabs('movingwing')" />
        </td>
        <td id="tdLock">
            <asp:DropDownList ID="dlstLock" AutoPostBack="false"
                              OnSelectedIndexChanged="ctl_valChanged"
                              onChange="clearFollowingTabs('movingwing')" />
        </td>
        @{
            List<TRSH_LOCK_Class> lstPartLocks = PrApiCalls.getPartLocks(doorConfig.TRSH_DOOR_HWCATCODE, ref errMsg);
        }
        <td id="tdTwoSidesIDSDril">
            <asp:CheckBox ID="chkbTwoSidesIDSDril" AutoPostBack="false" Enabled="false"
                          OnCheckedChanged="ctl_valChanged"
                          onChange="clearFollowingTabs('movingwing')" />
        </td>
        <td id="tdRafafa">
            <asp:UpdatePanel ID="uPanelRafafa">
                <ContentTemplate>
                    <asp:DropDownList ID="dlstRafafa" AutoPostBack="false"
                                      OnSelectedIndexChanged="ctl_valChanged"
                                      onChange="clearFollowingTabs('movingwing')">
                        <asp:ListItem> </asp:ListItem>
                        <asp:ListItem>1</asp:ListItem>
                        <asp:ListItem>2</asp:ListItem>
                        <asp:ListItem>כל הדלת</asp:ListItem>
                    </asp:DropDownList>
                </ContentTemplate>
            </asp:UpdatePanel>
        </td>
        <td id="tdLCDEye">
            <asp:CheckBox ID="chkbLCDEye" AutoPostBack="false"
                          OnCheckedChanged="ctl_valChanged"
                          onChange="clearFollowingTabs('movingwing')" />
        </td>
    </tr>
</table>
<!-- end table MovingWingL3 -->
@code {
    //bool  x1 = Helper.setHideFld(1, true);

}

<!-- end divMovingWing -->
